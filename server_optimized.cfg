# ==========================================
# HorizonRP v2.0 - Оптимизированная конфигурация
# ==========================================

echo "Загрузка конфигурации HorizonRP v2.0..."

# ==========================================
# Основные настройки сервера
# ==========================================
hostname "HorizonRP v2.0 | Ролевой сервер | Оптимизированный"
gamemode0 new_optimized 1
language Russian
weburl "www.horizonrp.com"
mapname "San Andreas"

# ==========================================
# Сетевые настройки
# ==========================================
port 7777
maxplayers 50
announce 1
query 1
chatlogging 1
lanmode 0

# ==========================================
# Безопасность и защита
# ==========================================
rcon_password "HrP_2024_SecurePass!"
password ""

# Ограничения подключений
bind "127.0.0.1"
maxnpc 10

# ==========================================
# Производительность и оптимизация
# ==========================================

# Оптимизированные настройки синхронизации
onfoot_rate 30      # Было 40, снижено для экономии трафика
incar_rate 30       # Было 40, снижено для экономии трафика  
weapon_rate 30      # Было 40, снижено для экономии трафика

# Настройки стримера для лучшей производительности
stream_distance 250.0    # Было 300.0, снижено для производительности
stream_rate 800          # Было 1000, снижено для оптимизации

# ==========================================
# Загрузка плагинов (оптимизированный порядок)
# ==========================================
plugins mysql.so streamer.so pawncmd.so crashdetect.so profiler.so

# ==========================================
# Загрузка фильтерскриптов
# ==========================================
filterscripts

# ==========================================
# Настройки логирования
# ==========================================
logtimeformat "[%d.%m.%Y %H:%M:%S]"

# Включаем все типы логов для отладки
logqueries 1
db_logging 1

# ==========================================
# Настройки безопасности игроков
# ==========================================

# Анти-флуд настройки
messageslimit 500        # Максимум сообщений в секунду
messageholelimit 3000    # Размер буфера сообщений  
ackslimit 3000          # Лимит ACK пакетов
playertimeout 10000     # Таймаут игрока (10 секунд)

# ==========================================
# Дополнительные настройки
# ==========================================

# Отключаем неиспользуемые функции для производительности
sleep 5                 # Задержка между обновлениями (мс)
timestamp 1            # Включаем timestamps в логах

# Настройки записи
output 1               # Включаем вывод в консоль
echo "HorizonRP v2.0 успешно настроен!"

# ==========================================
# Расширенные настройки производительности  
# ==========================================

# Оптимизация памяти
connseedtime 300000    # Время обновления seed для подключений
conncookies 1          # Включаем cookies для защиты
cookielogging 0        # Отключаем логирование cookies

# Настройки времени
minconnectiontime 0    # Минимальное время между подключениями
lagcompmode 1          # Включаем lag compensation

# ==========================================
# Мониторинг и статистика
# ==========================================

# Включаем мониторинг производительности
enableprofiling 1      # Включаем профилирование
sampling_rate 100      # Частота сэмплирования

# Статистика сети
netstats 1             # Включаем сетевую статистику
rcon 1                 # Включаем RCON

# ==========================================
# Настройки для режима разработки (закомментированы)
# ==========================================

# Для отладки - раскомментировать при необходимости
# debug 1
# plugins mysql.so streamer.so pawncmd.so crashdetect.so profiler.so sscanf.so
# maxnpc 0

echo "Конфигурация загружена. Сервер готов к запуску!"

# ==========================================
# Информация о сервере
# ==========================================

# Версия: HorizonRP v2.0
# Дата: 2024
# Кодировка: UTF-8  
# MySQL: Оптимизированная структура БД
# Производительность: Высокая
# Безопасность: Улучшенная